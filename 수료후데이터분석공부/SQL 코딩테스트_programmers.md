# SQL 코딩테스트_programmers



### [SELECT]

1. 모든 레코드 조회하기

```sql
SELECT *
FROM ANIMAL_INS
ORDER BY ANIMAL_ID;
```



2. 역순 정렬하기

```sql
SELECT NAME, DATETIME
FROM ANIMAL_INS
ORDER BY ANIMAL_ID DESC;
```



3. 아픈 동물 찾기

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION = 'Sick'
ORDER BY ANIMAL_ID;
```



4. 어린 동물 찾기

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION != 'Aged'
ORDER BY ANIMAL_ID;
```



5. 동물의 아이디와 이름

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
ORDER BY ANIMAL_ID;
```



6. 여러 기준으로 정렬하기

```sql
SELECT ANIMAL_ID, NAME, DATETIME
FROM ANIMAL_INS
ORDER BY NAME, DATETIME DESC;
```



7. 상위 n개 레코드

```sql
SELECT NAME
FROM (
    SELECT *
    FROM ANIMAL_INS
    ORDER BY DATETIME
)
WHERE rownum = 1;
```





### [SUM, MAX, MIN]

1. 최댓값 구하기

```sql
SELECT MAX(DATETIME) as 시간
FROM ANIMAL_INS
```



2. 최솟값 구하기

```sql
SELECT MIN(DATETIME) 시간
FROM ANIMAL_INS;
```



3. 동물 수 구하기

```sql
SELECT COUNT(*)
FROM ANIMAL_INS;
```



4. 중복 제거하기

```sql
SELECT COUNT(*)
FROM (
    SELECT DISTINCT(NAME)
    FROM ANIMAL_INS
    WHERE NAME is not null
);
```

```sql
SELECT COUNT(DISTINCT NAME)
FROM ANIMAL_INS
# WHERE NAME IS NOT NULL
```





### [IS NULL]

1. 이름이 없는 동물의 아이디

```sql
SELECT ANIMAL_ID
FROM ANIMAL_INS
WHERE NAME is null
ORDER BY ANIMAL_ID;
```



2. 이름이 있는 동물의 아이디

```sql
SELECT ANIMAL_ID
FROM ANIMAL_INS
WHERE NAME is not null
ORDER BY ANIMAL_ID;
```



3. NULL 처리하기

```sql
SELECT ANIMAL_TYPE, NVL(NAME, 'No name'), SEX_UPON_INTAKE
FROM ANIMAL_INS
ORDER BY ANIMAL_ID;
```



### [GROUP BY]

1. 고양이와 개는 몇 마리 있을까

```sql
SELECT ANIMAL_TYPE, COUNT(ANIMAL_TYPE) as count
FROM ANIMAL_INS
WHERE ANIMAL_TYPE in ('Cat','Dog')
GROUP BY ANIMAL_TYPE
ORDER BY ANIMAL_TYPE;
```



2. 동명 동물 수 찾기

```sql
SELECT NAME, COUNT(NAME) as COUNT
FROM ANIMAL_INS
WHERE NAME is not null
GROUP BY NAME
HAVING COUNT(NAME) >= 2
ORDER BY NAME;
```



3. 입양 시각 구하기(1)

```sql
SELECT hour, COUNT(*)
FROM (
    SELECT TO_CHAR(DATETIME, 'hh24') as hour
    FROM ANIMAL_OUTS
)
GROUP BY hour
HAVING hour between 9 and 20
ORDER BY hour;
```



4. 입양 시각 구하기(2)

```sql
SELECT L.hour, NVL(count, 0)
FROM
    (SELECT Level-1 as hour
    FROM dual
    CONNECT BY LEVEL <=24) L,
    (SELECT TO_CHAR(DATETIME, 'hh24') as hour, COUNT(*) as count
    FROM ANIMAL_OUTS
    GROUP BY TO_CHAR(DATETIME, 'hh24')
    ORDER BY hour) H
WHERE L.hour = H.hour(+)
ORDER BY L.hour;
```



### [JOIN]

1. 없어진 기록 찾기

```sql
SELECT ANIMAL_ID, B.NAME
FROM ANIMAL_INS A RIGHT OUTER JOIN ANIMAL_OUTS B USING (ANIMAL_ID)
WHERE INTAKE_CONDITION IS NULL
ORDER BY ANIMAL_ID;
```

```sql
SELECT B.ANIMAL_ID, B.NAME
FROM ANIMAL_INS A, ANIMAL_OUTS B
WHERE A.ANIMAL_ID(+) = B.ANIMAL_ID
AND INTAKE_CONDITION is null
ORDER BY B.ANIMAL_ID;
```



2. 있었는데요 없었습니다

```sql
SELECT ANIMAL_ID, B.NAME
FROM ANIMAL_INS A INNER JOIN ANIMAL_OUTS B USING (ANIMAL_ID)
WHERE A.DATETIME > B.DATETIME
ORDER BY A.DATETIME
```



3. 오랜 기간 보호한 동물(1)

```sql
SELECT *
FROM
   ( SELECT A.NAME, A.DATETIME
    FROM ANIMAL_INS A LEFT OUTER JOIN ANIMAL_OUTS B USING (ANIMAL_ID)
    WHERE SEX_UPON_OUTCOME is null
    ORDER BY A.DATETIME)
WHERE rownum <=3;
```



4. 보호소에서 중성화한 동물

```sql
SELECT ANIMAL_ID, A.ANIMAL_TYPE, A.NAME
FROM ANIMAL_INS A INNER JOIN ANIMAL_OUTS B USING (ANIMAL_ID)
WHERE B.SEX_UPON_OUTCOME NOT LIKE 'Intact%'
AND A.SEX_UPON_INTAKE LIKE 'Intact%'
ORDER BY ANIMAL_ID
```



### [String, Date]

1. 루시와 엘라 찾기

```sql
SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE
FROM ANIMAL_INS
WHERE NAME in ('Lucy', 'Ella','Pickle','Rogan','Sabrina','Mitty')
ORDER BY ANIMAL_ID
```



2. 이름에 el이 들어가는 동물 찾기

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE (NAME LIKE '%el%'
OR NAME LIKE 'El%')
AND ANIMAL_TYPE = 'Dog'
ORDER BY NAME;
```



3. 중성화 여부 파악하기

```sql
SELECT ANIMAL_ID, NAME,
    CASE
    WHEN SEX_UPON_INTAKE LIKE 'Neutered%' THEN 'O'
    WHEN SEX_UPON_INTAKE LIKE 'Spayed%' THEN 'O' 
    ELSE 'X'
    END AS 중성화
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
```



4. 오랜 기간 보호한 동물(2)

```sql
SELECT id, name
FROM
    (SELECT A.NAME name, ANIMAL_ID id, MONTHS_BETWEEN(B.DATETIME, A.DATETIME) period
    FROM ANIMAL_INS A INNER JOIN ANIMAL_OUTS B USING (ANIMAL_ID)
    ORDER BY period DESC)
WHERE rownum <=2;
```



5. DATETIME에서 DATE로 형 변환

```sql
SELECT ANIMAL_ID, NAME, TO_CHAR(DATETIME, 'YYYY-MM-DD') as 날짜
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
```



### [Summer/Winter Coding(2019)]

우유와 요거트가 담긴 장바구니

```sql
SELECT DISTINCT(CART_ID)
FROM CART_PRODUCTS
WHERE NAME='Milk'
AND CART_ID in (SELECT CART_ID FROM CART_PRODUCTS WHERE NAME='Yogurt')
ORDER BY CART_ID
```

