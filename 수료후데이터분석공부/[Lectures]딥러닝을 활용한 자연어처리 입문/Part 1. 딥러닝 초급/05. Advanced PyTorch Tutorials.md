# 05. Advanced PyTorch Tutorials

## 01. PyTorch Dataset

### 1. Read & Split

Read tabular dataset, shuffling before split, split train, valid, and test set.

### 2. Preprocessing

Remove unnecessary rows, standard or Min/Max Scaling based on training set.

### 3. Iterator

Shuffle for each epoch, get tensor chunk with mini-batch size, yield the mini-batch for each iteration.

- Read & Split, Preprocessing ⇒ 

  ```
  torch.utils.data.Dataset
  ```

  - **init**(self, *args, *kwargs): 데이터 읽어오기
  - **len**(self): 데이터 크기 알기
  - **getitem**(self, idx): 전처리 및 미니배치를 위한 샘플 반환

- Iterator ⇒ `torch.utils.data.DataLoader`



## 02. 실습 PyTorch Dataset을 활용하여 구현하기

jupyter notebook에서 진행



## 03. PyTorch Ignite

### Boilerplate

- 학습 scheme이 비슷할 경우, 모델과 dataset을 제외한 코드는 거의 동일함

### PyTorch Ignite

https://github.com/pytorch/ignite

- PyTorch 공식 라이브러리
- Call-back 함수를 위한 event가 잘 정의되어 있다.
- 손 쉬운 학습 통계 logging
- 진입 장벽 존재/기본 설계의 아쉬움

### Engine

```
ignite.engine.Engine(*process_function*)
```

process_function을 작동시켜주는 것

- process_function은 feed-forwad, loss 계산, Back-propagation, Gradient Descent 까지의 과정
- 사용자가 직접 코딩하거나 `ignite.engine.create_supervised_trainer` 함수를 통해 코딩 없이 사용
- `train_engine.run(train_loader, max_epochs=self.config.n_epochs,)`

### Attach Metrics

process_function의 return 값 활용

### Add Event Handler(Call-back function)

- add_event_handler 함수 활용: call-back 함수의 인터페이스가 복잡할 때

  `train_engine.add_event_handler(Events.EPOCH_COMPLETED, run_validationa, validation_engine, valid_loader,)`

- decorator 활용: call-back의 인터페이스가 표준을 따를 때

  `@train_engine.on(Events.EPOCH_COMPLETED)`



## 04. 실습 PyTorch Ignite를 활용하여 구현하기

jupyter notebook으로 진행